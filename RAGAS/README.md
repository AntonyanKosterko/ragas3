# üöÄ RAG –°–∏—Å—Ç–µ–º–∞ —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º SberQuAD

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

RAG (Retrieval-Augmented Generation) —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ SberQuAD.

### üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- **–î–∞—Ç–∞—Å–µ—Ç**: SberQuAD (45,328 –ø—Ä–∏–º–µ—Ä–æ–≤, 5,933 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞)
- **–ú–æ–¥–µ–ª–∏**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è CPU
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: Gradio –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- **MLflow**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
```bash
python load_sberquad.py
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
python test_rag.py --config config/base_config.yaml --max-samples 100
```

### 3. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```bash
python app.py --config config/base_config.yaml --interface gradio
```
–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: http://localhost:7860

### 4. MLflow UI
```bash
mlflow ui --backend-store-uri file:./mlruns --host 0.0.0.0 --port 5000
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
RAGAS/
‚îú‚îÄ‚îÄ load_sberquad.py          # –ó–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞—Ç–∞—Å–µ—Ç–∞ SberQuAD
‚îú‚îÄ‚îÄ test_rag.py              # –¢–µ—Å—Ç–µ—Ä RAG —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ app.py                   # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ main.py                  # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å MLflow
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ base_config.yaml     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ src/                     # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ datasets/sberquad/       # –î–∞—Ç–∞—Å–µ—Ç SberQuAD
‚îÇ   ‚îú‚îÄ‚îÄ documents_for_rag.json    # 500 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ qa_pairs.json            # 200 –≤–æ–ø—Ä–æ—Å–æ–≤-–æ—Ç–≤–µ—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ vector_db/               # –í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î
‚îî‚îÄ‚îÄ results/                 # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `config/base_config.yaml`:

- **–≠–º–±–µ–¥–¥–∏–Ω–≥**: `all-MiniLM-L6-v2` (–±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–ª—è CPU)
- **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä**: –ö–∞—Å—Ç–æ–º–Ω–∞—è RAG –º–æ–¥–µ–ª—å
- **–í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î**: FAISS (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è CPU)
- **–†–µ—Ç—Ä–∏–≤–µ—Ä**: 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç:
- **ROUGE** (1, 2, L) - –∫–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **BLEU** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω—É
- **Exact Match** - —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
- **Response Time** - –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- **Source Coverage** - –ø–æ–∫—Ä—ã—Ç–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- 8GB RAM (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- CPU (GPU –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `results/rag_test_results.json` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- MLflow UI - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤:
```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (10 –ø—Ä–∏–º–µ—Ä–æ–≤)
python test_rag.py --config config/base_config.yaml --max-samples 10

# –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç (100 –ø—Ä–∏–º–µ—Ä–æ–≤)
python test_rag.py --config config/base_config.yaml --max-samples 100

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î
python test_rag.py --config config/base_config.yaml --rebuild-vector-db
```

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
- –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:7860
- –í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –ü–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ SberQuAD

## üìù –õ–æ–≥–∏

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `logs/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r requirements.txt`
2. –ó–∞–≥—Ä—É–∂–µ–Ω –ª–∏ –¥–∞—Ç–∞—Å–µ—Ç: `python load_sberquad.py`
3. –°–æ–∑–¥–∞–Ω–∞ –ª–∏ –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î: `python test_rag.py --rebuild-vector-db`